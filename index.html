<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Å–ø–µ–∫—Ç: –ß–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f4f8;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .instruction {
            background: #e6fffa;
            color: #234e52;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            font-size: 16px;
            border: 2px solid #4fd1c7;
        }

        .shapes-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .shape-container {
            text-align: center;
            background: #f8fafc;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }

        .shape-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .shape-canvas {
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            cursor: pointer;
            margin: 0 auto;
            display: block;
        }

        .info-display {
            margin-top: 15px;
            padding: 15px;
            background: #2d3748;
            color: white;
            border-radius: 8px;
            min-height: 60px;
            font-size: 16px;
            line-height: 1.6;
        }

        .legend {
            background: #1a202c;
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .legend h3 {
            margin-top: 0;
            color: #4fd1c7;
            text-align: center;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 6px;
        }

        .color-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .highlight-vertices { background: #ff6b6b; }
        .highlight-sides { background: #4ecdc4; }
        .highlight-diagonals { background: #ffe66d; }
        .highlight-adjacent { background: #ff8c42; }
        .highlight-opposite { background: #a8e6cf; }
    </style>
</head>
<body>
<div class="container">
    <h1>üìê –ö–æ–Ω—Å–ø–µ–∫—Ç: –ß–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫–∏</h1>

    <div class="instruction">
        <strong>–ù–∞—Ç–∏—Å–∫–∞–π—Ç–µ –Ω–∞ —Ä—ñ–∑–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫—ñ–≤!</strong><br>
        –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –≤–µ—Ä—à–∏–Ω—É, —Å—Ç–æ—Ä–æ–Ω—É –∞–±–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Ñ—ñ–≥—É—Ä–∏, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ
    </div>

    <div class="shapes-grid">
        <div class="shape-container">
            <div class="shape-title">–ö–≤–∞–¥—Ä–∞—Ç</div>
            <canvas class="shape-canvas" id="square" width="300" height="250"></canvas>
            <div class="info-display" id="square-info">
                –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –π–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            </div>
        </div>

        <div class="shape-container">
            <div class="shape-title">–ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫</div>
            <canvas class="shape-canvas" id="rectangle" width="300" height="250"></canvas>
            <div class="info-display" id="rectangle-info">
                –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –π–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            </div>
        </div>

        <div class="shape-container">
            <div class="shape-title">–†–æ–º–±</div>
            <canvas class="shape-canvas" id="rhombus" width="300" height="250"></canvas>
            <div class="info-display" id="rhombus-info">
                –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —Ä–æ–º–± –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –π–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            </div>
        </div>

        <div class="shape-container">
            <div class="shape-title">–î–æ–≤—ñ–ª—å–Ω–∏–π —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫</div>
            <canvas class="shape-canvas" id="arbitrary" width="300" height="250"></canvas>
            <div class="info-display" id="arbitrary-info">
                –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –π–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            </div>
        </div>
    </div>

    <div class="legend">
        <h3>üé® –õ–µ–≥–µ–Ω–¥–∞ –∫–æ–ª—å–æ—Ä—ñ–≤</h3>
        <div class="legend-grid">
            <div class="legend-item">
                <div class="color-box highlight-vertices"></div>
                <span>–í–µ—Ä—à–∏–Ω–∏ (A, B, C, D)</span>
            </div>
            <div class="legend-item">
                <div class="color-box highlight-sides"></div>
                <span>–°—Ç–æ—Ä–æ–Ω–∏ —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫–∞</span>
            </div>
            <div class="legend-item">
                <div class="color-box highlight-diagonals"></div>
                <span>–î—ñ–∞–≥–æ–Ω–∞–ª—ñ</span>
            </div>
            <div class="legend-item">
                <div class="color-box highlight-adjacent"></div>
                <span>–°—É—Å—ñ–¥–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏</span>
            </div>
            <div class="legend-item">
                <div class="color-box highlight-opposite"></div>
                <span>–ü—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏</span>
            </div>
        </div>
    </div>
</div>

<script>
  class QuadrilateralTeacher {
    constructor(canvasId, shapeType) {
      this.canvas = document.getElementById(canvasId);
      this.ctx = this.canvas.getContext('2d');
      this.infoDiv = document.getElementById(canvasId + '-info');
      this.shapeType = shapeType;
      this.currentHighlight = null;

      this.setupShape();
      this.canvas.addEventListener('click', (e) => this.handleClick(e));
      this.draw();
    }

    setupShape() {
      const centerX = this.canvas.width / 2;
      const centerY = this.canvas.height / 2;

      switch(this.shapeType) {
        case 'square':
          const size = 60;
          this.vertices = [
            {x: centerX - size, y: centerY - size, label: 'A'},
            {x: centerX + size, y: centerY - size, label: 'B'},
            {x: centerX + size, y: centerY + size, label: 'C'},
            {x: centerX - size, y: centerY + size, label: 'D'}
          ];
          break;

        case 'rectangle':
          const w = 80, h = 50;
          this.vertices = [
            {x: centerX - w, y: centerY - h, label: 'A'},
            {x: centerX + w, y: centerY - h, label: 'B'},
            {x: centerX + w, y: centerY + h, label: 'C'},
            {x: centerX - w, y: centerY + h, label: 'D'}
          ];
          break;

        case 'rhombus':
          const r = 70;
          this.vertices = [
            {x: centerX, y: centerY - r, label: 'A'},
            {x: centerX + r, y: centerY, label: 'B'},
            {x: centerX, y: centerY + r, label: 'C'},
            {x: centerX - r, y: centerY, label: 'D'}
          ];
          break;

        case 'arbitrary':
          this.vertices = [
            {x: centerX - 60, y: centerY - 40, label: 'A'},
            {x: centerX + 80, y: centerY - 30, label: 'B'},
            {x: centerX + 50, y: centerY + 60, label: 'C'},
            {x: centerX - 70, y: centerY + 40, label: 'D'}
          ];
          break;
      }
    }

    draw() {
      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

      // Draw quadrilateral
      this.ctx.beginPath();
      this.ctx.moveTo(this.vertices[0].x, this.vertices[0].y);
      for (let i = 1; i < this.vertices.length; i++) {
        this.ctx.lineTo(this.vertices[i].x, this.vertices[i].y);
      }
      this.ctx.closePath();
      this.ctx.strokeStyle = '#2d3748';
      this.ctx.lineWidth = 3;
      this.ctx.stroke();
      this.ctx.fillStyle = 'rgba(66, 153, 225, 0.1)';
      this.ctx.fill();

      // Draw based on current highlight
      if (this.currentHighlight) {
        this.drawHighlight();
      }

      // Draw vertices
      this.vertices.forEach(vertex => {
        this.ctx.beginPath();
        this.ctx.arc(vertex.x, vertex.y, 8, 0, 2 * Math.PI);
        this.ctx.fillStyle = '#ff6b6b';
        this.ctx.fill();
        this.ctx.strokeStyle = 'white';
        this.ctx.lineWidth = 2;
        this.ctx.stroke();

        // Draw labels
        this.ctx.fillStyle = '#1a202c';
        this.ctx.font = 'bold 16px Arial';
        this.ctx.fillText(vertex.label, vertex.x + 12, vertex.y - 8);
      });
    }

    drawHighlight() {
      const h = this.currentHighlight;
      this.ctx.save();

      switch(h.type) {
        case 'vertex':
          this.highlightVertex(h.index);
          break;
        case 'side':
          this.highlightSide(h.index);
          break;
        case 'diagonal':
          this.highlightDiagonals();
          break;
        case 'all-vertices':
          this.highlightAllVertices();
          break;
        case 'all-sides':
          this.highlightAllSides();
          break;
      }

      this.ctx.restore();
    }

    highlightVertex(index) {
      const vertex = this.vertices[index];

      // Highlight clicked vertex
      this.ctx.beginPath();
      this.ctx.arc(vertex.x, vertex.y, 12, 0, 2 * Math.PI);
      this.ctx.fillStyle = '#ff6b6b';
      this.ctx.fill();

      // Highlight adjacent vertices
      const prev = this.vertices[(index - 1 + 4) % 4];
      const next = this.vertices[(index + 1) % 4];

      [prev, next].forEach(v => {
        this.ctx.beginPath();
        this.ctx.arc(v.x, v.y, 10, 0, 2 * Math.PI);
        this.ctx.fillStyle = '#ff8c42';
        this.ctx.fill();
      });

      // Highlight opposite vertex
      const opposite = this.vertices[(index + 2) % 4];
      this.ctx.beginPath();
      this.ctx.arc(opposite.x, opposite.y, 10, 0, 2 * Math.PI);
      this.ctx.fillStyle = '#a8e6cf';
      this.ctx.fill();
    }

    highlightSide(index) {
      const start = this.vertices[index];
      const end = this.vertices[(index + 1) % 4];

      // Highlight clicked side
      this.ctx.beginPath();
      this.ctx.moveTo(start.x, start.y);
      this.ctx.lineTo(end.x, end.y);
      this.ctx.strokeStyle = '#4ecdc4';
      this.ctx.lineWidth = 6;
      this.ctx.stroke();

      // Highlight adjacent sides
      const prevIndex = (index - 1 + 4) % 4;
      const nextIndex = (index + 1) % 4;

      [prevIndex, nextIndex].forEach(i => {
        const s = this.vertices[i];
        const e = this.vertices[(i + 1) % 4];
        this.ctx.beginPath();
        this.ctx.moveTo(s.x, s.y);
        this.ctx.lineTo(e.x, e.y);
        this.ctx.strokeStyle = '#ff8c42';
        this.ctx.lineWidth = 4;
        this.ctx.stroke();
      });

      // Highlight opposite side
      const oppositeIndex = (index + 2) % 4;
      const oppStart = this.vertices[oppositeIndex];
      const oppEnd = this.vertices[(oppositeIndex + 1) % 4];
      this.ctx.beginPath();
      this.ctx.moveTo(oppStart.x, oppStart.y);
      this.ctx.lineTo(oppEnd.x, oppEnd.y);
      this.ctx.strokeStyle = '#a8e6cf';
      this.ctx.lineWidth = 4;
      this.ctx.stroke();
    }

    highlightDiagonals() {
      // Diagonal AC
      this.ctx.beginPath();
      this.ctx.moveTo(this.vertices[0].x, this.vertices[0].y);
      this.ctx.lineTo(this.vertices[2].x, this.vertices[2].y);
      this.ctx.strokeStyle = '#ffe66d';
      this.ctx.lineWidth = 4;
      this.ctx.setLineDash([8, 4]);
      this.ctx.stroke();

      // Diagonal BD
      this.ctx.beginPath();
      this.ctx.moveTo(this.vertices[1].x, this.vertices[1].y);
      this.ctx.lineTo(this.vertices[3].x, this.vertices[3].y);
      this.ctx.strokeStyle = '#ffe66d';
      this.ctx.lineWidth = 4;
      this.ctx.stroke();

      this.ctx.setLineDash([]);
    }

    highlightAllVertices() {
      this.vertices.forEach(vertex => {
        this.ctx.beginPath();
        this.ctx.arc(vertex.x, vertex.y, 12, 0, 2 * Math.PI);
        this.ctx.fillStyle = '#ff6b6b';
        this.ctx.fill();
      });
    }

    highlightAllSides() {
      for (let i = 0; i < 4; i++) {
        const start = this.vertices[i];
        const end = this.vertices[(i + 1) % 4];
        this.ctx.beginPath();
        this.ctx.moveTo(start.x, start.y);
        this.ctx.lineTo(end.x, end.y);
        this.ctx.strokeStyle = '#4ecdc4';
        this.ctx.lineWidth = 6;
        this.ctx.stroke();
      }
    }

    handleClick(e) {
      const rect = this.canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      // Check vertex click
      for (let i = 0; i < this.vertices.length; i++) {
        const vertex = this.vertices[i];
        const distance = Math.sqrt((x - vertex.x) ** 2 + (y - vertex.y) ** 2);
        if (distance < 15) {
          this.showVertexInfo(i);
          return;
        }
      }

      // Check side click
      for (let i = 0; i < 4; i++) {
        if (this.isPointOnSide(x, y, i)) {
          this.showSideInfo(i);
          return;
        }
      }

      // Check if inside quadrilateral
      if (this.isPointInside(x, y)) {
        this.showGeneralInfo();
        return;
      }

      // Click outside - show diagonals
      this.showDiagonalInfo();
    }

    isPointOnSide(x, y, sideIndex) {
      const start = this.vertices[sideIndex];
      const end = this.vertices[(sideIndex + 1) % 4];

      const distance = this.pointToLineDistance(x, y, start.x, start.y, end.x, end.y);

      // Check if point is within the line segment bounds
      const minX = Math.min(start.x, end.x) - 10;
      const maxX = Math.max(start.x, end.x) + 10;
      const minY = Math.min(start.y, end.y) - 10;
      const maxY = Math.max(start.y, end.y) + 10;

      return distance < 10 && x >= minX && x <= maxX && y >= minY && y <= maxY;
    }

    pointToLineDistance(px, py, x1, y1, x2, y2) {
      const dx = x2 - x1;
      const dy = y2 - y1;
      const length = Math.sqrt(dx * dx + dy * dy);
      if (length === 0) return Math.sqrt((px - x1) ** 2 + (py - y1) ** 2);

      const t = Math.max(0, Math.min(1, ((px - x1) * dx + (py - y1) * dy) / (length * length)));
      const projection = { x: x1 + t * dx, y: y1 + t * dy };
      return Math.sqrt((px - projection.x) ** 2 + (py - projection.y) ** 2);
    }

    isPointInside(x, y) {
      let inside = false;
      for (let i = 0, j = 3; i < 4; j = i++) {
        const xi = this.vertices[i].x, yi = this.vertices[i].y;
        const xj = this.vertices[j].x, yj = this.vertices[j].y;

        if (((yi > y) !== (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)) {
          inside = !inside;
        }
      }
      return inside;
    }

    showVertexInfo(index) {
      const vertex = this.vertices[index];
      const adjacent = [
        this.vertices[(index - 1 + 4) % 4].label,
        this.vertices[(index + 1) % 4].label
      ];
      const opposite = this.vertices[(index + 2) % 4].label;

      this.currentHighlight = { type: 'vertex', index: index };
      this.draw();

      this.infoDiv.innerHTML = `
                    <strong>–í–µ—Ä—à–∏–Ω–∞ ${vertex.label}</strong><br>
                    üìç <span style="color: #ff8c42">–°—É—Å—ñ–¥–Ω—ñ –≤–µ—Ä—à–∏–Ω–∏:</span> ${adjacent.join(', ')}<br>
                    üìç <span style="color: #a8e6cf">–ü—Ä–æ—Ç–∏–ª–µ–∂–Ω–∞ –≤–µ—Ä—à–∏–Ω–∞:</span> ${opposite}<br>
                    üìù –í–µ—Ä—à–∏–Ω–∞ - —Ü–µ —Ç–æ—á–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –¥–≤–æ—Ö —Å—Ç–æ—Ä—ñ–Ω
                `;
    }

    showSideInfo(index) {
      const sideNames = ['AB', 'BC', 'CD', 'DA'];
      const currentSide = sideNames[index];
      const adjacent = [
        sideNames[(index - 1 + 4) % 4],
        sideNames[(index + 1) % 4]
      ];
      const opposite = sideNames[(index + 2) % 4];

      this.currentHighlight = { type: 'side', index: index };
      this.draw();

      this.infoDiv.innerHTML = `
                    <strong>–°—Ç–æ—Ä–æ–Ω–∞ ${currentSide}</strong><br>
                    üìè <span style="color: #ff8c42">–°—É—Å—ñ–¥–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏:</span> ${adjacent.join(', ')}<br>
                    üìè <span style="color: #a8e6cf">–ü—Ä–æ—Ç–∏–ª–µ–∂–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞:</span> ${opposite}<br>
                    üìù –°—É—Å—ñ–¥–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω—É –≤–µ—Ä—à–∏–Ω—É
                `;
    }

    showDiagonalInfo() {
      this.currentHighlight = { type: 'diagonal' };
      this.draw();

      this.infoDiv.innerHTML = `
                    <strong>–î—ñ–∞–≥–æ–Ω–∞–ª—ñ —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫–∞</strong><br>
                    ‚ÜóÔ∏è <span style="color: #ffe66d">–î—ñ–∞–≥–æ–Ω–∞–ª—å AC:</span> –∑'—î–¥–Ω—É—î –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –≤–µ—Ä—à–∏–Ω–∏ A —ñ C<br>
                    ‚ÜôÔ∏è <span style="color: #ffe66d">–î—ñ–∞–≥–æ–Ω–∞–ª—å BD:</span> –∑'—î–¥–Ω—É—î –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –≤–µ—Ä—à–∏–Ω–∏ B —ñ D<br>
                    üìù –î—ñ–∞–≥–æ–Ω–∞–ª—å - –≤—ñ–¥—Ä—ñ–∑–æ–∫ –º—ñ–∂ –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω–∏–º–∏ –≤–µ—Ä—à–∏–Ω–∞–º–∏
                `;
    }

    showGeneralInfo() {
      this.currentHighlight = { type: 'all-sides' };
      this.draw();

      const shapeInfo = {
        'square': '–ö–≤–∞–¥—Ä–∞—Ç - –≤—Å—ñ —Å—Ç–æ—Ä–æ–Ω–∏ —Ä—ñ–≤–Ω—ñ, –≤—Å—ñ –∫—É—Ç–∏ 90¬∞',
        'rectangle': '–ü—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫ - –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏ —Ä—ñ–≤–Ω—ñ, –≤—Å—ñ –∫—É—Ç–∏ 90¬∞',
        'rhombus': '–†–æ–º–± - –≤—Å—ñ —Å—Ç–æ—Ä–æ–Ω–∏ —Ä—ñ–≤–Ω—ñ, –ø—Ä–æ—Ç–∏–ª–µ–∂–Ω—ñ –∫—É—Ç–∏ —Ä—ñ–≤–Ω—ñ',
        'arbitrary': '–î–æ–≤—ñ–ª—å–Ω–∏–π —á–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫ - –∑–∞–≥–∞–ª—å–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫'
      };

      this.infoDiv.innerHTML = `
                    <strong>${shapeInfo[this.shapeType]}</strong><br>
                    üî∑ <span style="color: #4ecdc4">–°—Ç–æ—Ä–æ–Ω–∏:</span> AB, BC, CD, DA<br>
                    üî¥ <span style="color: #ff6b6b">–í–µ—Ä—à–∏–Ω–∏:</span> A, B, C, D<br>
                    üìù –ß–æ—Ç–∏—Ä–∏–∫—É—Ç–Ω–∏–∫ –º–∞—î 4 –≤–µ—Ä—à–∏–Ω–∏, 4 —Å—Ç–æ—Ä–æ–Ω–∏ —ñ 2 –¥—ñ–∞–≥–æ–Ω–∞–ª—ñ
                `;
    }
  }

  // Initialize all shapes
  window.addEventListener('load', () => {
    new QuadrilateralTeacher('square', 'square');
    new QuadrilateralTeacher('rectangle', 'rectangle');
    new QuadrilateralTeacher('rhombus', 'rhombus');
    new QuadrilateralTeacher('arbitrary', 'arbitrary');
  });
</script>
</body>
</html>