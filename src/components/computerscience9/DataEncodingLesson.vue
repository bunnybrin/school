<template>
  <div class="container">
    <section id="section1" class="section section-1">
      <h2>1Ô∏è‚É£ –ö–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö</h2>

      <div class="definition-box">
        <strong>–ö–æ–¥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö</strong> ‚Äì —Ü–µ –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É –≤ —ñ–Ω—à–∏–π –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è, –ø–µ—Ä–µ–¥–∞—á—ñ –∞–±–æ –æ–±—Ä–æ–±–∫–∏ –∫–æ–º–ø'—é—Ç–µ—Ä–æ–º.
      </div>

      <div class="definition-box">
        <strong>–î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è</strong> ‚Äì —Ü–µ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É.
      </div>

      <div class="visual-grid">
        <div class="info-card">
          <span class="icon">üìù</span>
          <h4>–¢–µ–∫—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ</h4>
          <p>–°–∏–º–≤–æ–ª–∏, —Å–ª–æ–≤–∞, —Ä–µ—á–µ–Ω–Ω—è</p>
        </div>
        <div class="info-card">
          <span class="icon">üé®</span>
          <h4>–ì—Ä–∞—Ñ—ñ—á–Ω—ñ –¥–∞–Ω—ñ</h4>
          <p>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –∫–æ–ª—å–æ—Ä–∏, –ø—ñ–∫—Å–µ–ª—ñ</p>
        </div>
        <div class="info-card">
          <span class="icon">üéµ</span>
          <h4>–ú—É–ª—å—Ç–∏–º–µ–¥—ñ–π–Ω—ñ –¥–∞–Ω—ñ</h4>
          <p>–ê—É–¥—ñ–æ, –≤—ñ–¥–µ–æ, –∞–Ω—ñ–º–∞—Ü—ñ—è</p>
        </div>
      </div>

      <div class="example-box">
        <strong>üí° –ü—Ä–∏–∫–ª–∞–¥:</strong> –õ—ñ—Ç–µ—Ä–∞ "–ê" –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∞ —è–∫ —á–∏—Å–ª–æ 65 –≤ ASCII –∞–±–æ —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±—ñ—Ç—ñ–≤ 01000001.
      </div>
    </section>

    <section id="section2" class="section section-2">
      <h2>2Ô∏è‚É£ –ö–æ–¥—É–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö</h2>

      <div class="definition-box">
        <strong>ASCII</strong> (American Standard Code for Information Interchange) ‚Äì —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î 7 –±—ñ—Ç –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è 128 —Å–∏–º–≤–æ–ª—ñ–≤.
      </div>

      <div class="encoding-demo">
        <h3>üî§ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ —Ç–∞–±–ª–∏—Ü—è ASCII</h3>
        <div class="text-encoder">
          <div class="input-group">
            <label>–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç:</label>
            <input
              v-model="inputText"
              type="text"
              placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: Hello"
              maxlength="20"
            />
          </div>

          <div class="encoding-results">
            <div class="result-box">
              <h4>ASCII –∫–æ–¥–∏:</h4>
              <div class="code-display">
                {{ getAsciiCodes(inputText) }}
              </div>
            </div>

            <div class="result-box">
              <h4>–ë—ñ–Ω–∞—Ä–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è:</h4>
              <div class="binary-display">
                {{ getBinaryRepresentation(inputText) }}
              </div>
            </div>
          </div>
        </div>

        <div class="ascii-table">
          <h4>–û—Å–Ω–æ–≤–Ω—ñ ASCII —Å–∏–º–≤–æ–ª–∏:</h4>
          <div class="ascii-grid">
            <div
              v-for="code in asciiCodes"
              :key="code"
              class="ascii-cell"
              @click="addCharToInput(String.fromCharCode(code))"
              :title="`–ö–æ–¥: ${code}, –°–∏–º–≤–æ–ª: ${String.fromCharCode(code)}`"
            >
              <div class="ascii-char">{{ String.fromCharCode(code) }}</div>
              <div class="ascii-code">{{ code }}</div>
            </div>
          </div>
        </div>
      </div>

      <div class="unicode-section">
        <h3>üåç Unicode</h3>
        <div class="definition-box">
          <strong>Unicode</strong> ‚Äì —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–¥—É–≤–∞–Ω–Ω—è, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤—Å—ñ –º–æ–≤–∏ —Å–≤—ñ—Ç—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–æ 32 –±—ñ—Ç –Ω–∞ —Å–∏–º–≤–æ–ª.
        </div>

        <div class="unicode-examples">
          <div class="unicode-card" v-for="example in unicodeExamples" :key="example.char">
            <span class="unicode-char">{{ example.char }}</span>
            <div class="unicode-info">
              <div>–°–∏–º–≤–æ–ª: {{ example.name }}</div>
              <div>–ö–æ–¥: U+{{ example.code }}</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="section3" class="section section-3">
      <h2>3Ô∏è‚É£ –ö–æ–¥—É–≤–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤</h2>

      <div class="color-models">
        <h3>üé® RGB –º–æ–¥–µ–ª—å</h3>
        <div class="definition-box">
          <strong>RGB</strong> (Red, Green, Blue) ‚Äì –∞–¥–∏—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å –∫–æ–ª—å–æ—Ä—É, –¥–µ –∫–æ–∂–µ–Ω –∫–æ–ª—ñ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ç—Ä—å–æ–º–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –≤—ñ–¥ 0 –¥–æ 255.
        </div>

        <div class="rgb-demo">
          <div class="color-controls">
            <div class="slider-group">
              <label>üî¥ –ß–µ—Ä–≤–æ–Ω–∏–π (R):</label>
              <input
                type="range"
                min="0"
                max="255"
                v-model="rgbColor.r"
                class="color-slider red"
              />
              <span class="value">{{ rgbColor.r }}</span>
            </div>

            <div class="slider-group">
              <label>üü¢ –ó–µ–ª–µ–Ω–∏–π (G):</label>
              <input
                type="range"
                min="0"
                max="255"
                v-model="rgbColor.g"
                class="color-slider green"
              />
              <span class="value">{{ rgbColor.g }}</span>
            </div>

            <div class="slider-group">
              <label>üîµ –°–∏–Ω—ñ–π (B):</label>
              <input
                type="range"
                min="0"
                max="255"
                v-model="rgbColor.b"
                class="color-slider blue"
              />
              <span class="value">{{ rgbColor.b }}</span>
            </div>
          </div>

          <div class="color-preview">
            <div
              class="color-swatch"
              :style="{ backgroundColor: `rgb(${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b})` }"
            ></div>
            <div class="color-codes">
              <div><strong>RGB:</strong> {{ rgbColor.r }}, {{ rgbColor.g }}, {{ rgbColor.b }}</div>
              <div><strong>HEX:</strong> {{ getRgbHex() }}</div>
              <div><strong>–ë—ñ–Ω–∞—Ä–Ω–æ:</strong> {{ getRgbBinary() }}</div>
            </div>
          </div>
        </div>

        <h3>üñ®Ô∏è CMYK –º–æ–¥–µ–ª—å</h3>
        <div class="definition-box">
          <strong>CMYK</strong> (Cyan, Magenta, Yellow, Key/Black) ‚Äì —Å—É–±—Ç—Ä–∞–∫—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è –¥—Ä—É–∫—É, –¥–µ –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏—Ä–∞–∂–µ–Ω–∏–π —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö.
        </div>

        <div class="cmyk-demo">
          <div class="preset-colors">
            <div
              v-for="preset in colorPresets"
              :key="preset.name"
              class="preset-card"
              @click="applyCmykPreset(preset)"
            >
              <div
                class="preset-swatch"
                :style="{ backgroundColor: preset.hex }"
              ></div>
              <div class="preset-info">
                <div><strong>{{ preset.name }}</strong></div>
                <div>C:{{ preset.cmyk.c }}% M:{{ preset.cmyk.m }}% Y:{{ preset.cmyk.y }}% K:{{ preset.cmyk.k }}%</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="section4" class="section section-4">
      <h2>4Ô∏è‚É£ –ö–æ–¥—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤</h2>

      <div class="definition-box">
        –ë—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –≤ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤ (–≥—Ä—É–ø–∏ –∑ 8 –±—ñ—Ç—ñ–≤). –ö–æ–∂–µ–Ω –±–∞–π—Ç –º–æ–∂–µ –º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥ 0 –¥–æ 255.
      </div>

      <div class="file-upload-demo">
        <h3>üìÇ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É</h3>

        <div
          class="upload-zone"
          @drop="handleFileDrop"
          @dragover.prevent
          @dragenter.prevent
          :class="{ 'drag-over': isDragOver }"
          @dragenter="isDragOver = true"
          @dragleave="isDragOver = false"
        >
          <input
            type="file"
            ref="fileInput"
            @change="handleFileSelect"
            accept=".txt,.jpg,.png,.gif,.mp3,.pdf,.doc,.docx"
            style="display: none;"
          />
          <button @click="$refs.fileInput?.click()" class="upload-btn">
            üìÅ –û–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª
          </button>
          <p>–∞–±–æ –ø–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å —Ñ–∞–π–ª —Å—é–¥–∏</p>
          <small>–ü—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è: —Ç–µ–∫—Å—Ç, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –∞—É–¥—ñ–æ (–¥–æ 1–ú–ë)</small>

          <div v-if="uploadStatus" class="upload-status" :class="uploadStatus.type">
            {{ uploadStatus.message }}
          </div>
        </div>

        <div v-if="fileData" class="file-analysis">
          <div class="file-info">
            <h4>üìÑ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ–∞–π–ª:</h4>
            <div><strong>–ù–∞–∑–≤–∞:</strong> {{ fileData.name }}</div>
            <div><strong>–†–æ–∑–º—ñ—Ä:</strong> {{ fileData.size }} –±–∞–π—Ç</div>
            <div><strong>–¢–∏–ø:</strong> {{ fileData.type || '–ù–µ–≤—ñ–¥–æ–º–∏–π' }}</div>
          </div>

          <div class="binary-visualization">
            <h4>üî¢ –ü–µ—Ä—à—ñ 64 –±–∞–π—Ç–∏ —É —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö:</h4>

            <div class="format-tabs">
              <button
                v-for="format in binaryFormats"
                :key="format"
                @click="selectedFormat = format"
                :class="['format-btn', { active: selectedFormat === format }]"
              >
                {{ format }}
              </button>
            </div>

            <div class="binary-display">
              <div class="binary-content">
                {{ getFormattedBinary() }}
              </div>
            </div>
          </div>

          <div v-if="fileData.type?.startsWith('text/')" class="text-preview">
            <h4>üìù –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ —Ç–µ–∫—Å—Ç—É:</h4>
            <div class="text-content">{{ textContent }}</div>
          </div>
        </div>
      </div>
    </section>

    <section id="section5" class="section section-5">
      <h2>5Ô∏è‚É£ –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –≤–ø—Ä–∞–≤–∏</h2>

      <div class="decoder-tool">
        <h3>üîì –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è</h3>

        <div class="decoder-modes">
          <button
            v-for="mode in decoderModes"
            :key="mode.id"
            @click="decoderMode = mode.id"
            :class="['mode-btn', { active: decoderMode === mode.id }]"
          >
            {{ mode.name }}
          </button>
        </div>

        <div class="decoder-interface">
          <div class="input-section">
            <label>{{ getCurrentModeLabel() }}:</label>
            <textarea
              v-model="decodeInput"
              :placeholder="getCurrentModePlaceholder()"
              rows="4"
            ></textarea>
            <button @click="performDecode" class="decode-btn">üîç –î–µ–∫–æ–¥—É–≤–∞—Ç–∏</button>
          </div>

          <div v-if="decodeResult" class="result-section">
            <h4>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
            <div class="decode-output">{{ decodeResult }}</div>
          </div>
        </div>
      </div>

      <div class="practice-exercises">
        <h3>üéØ –ó–∞–≤–¥–∞–Ω–Ω—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏</h3>

        <div class="exercise-list">
          <div v-for="(exercise, index) in practiceExercises" :key="index" class="exercise-card">
            <div class="exercise-question">
              <strong>–ó–∞–≤–¥–∞–Ω–Ω—è {{ index + 1 }}:</strong> {{ exercise.question }}
            </div>
            <div class="exercise-hint">
              <small>üí° –ü—ñ–¥–∫–∞–∑–∫–∞: {{ exercise.hint }}</small>
            </div>
            <div class="exercise-answer">
              <input
                v-model="exercise.userAnswer"
                type="text"
                :placeholder="exercise.placeholder"
              />
              <button @click="checkAnswer(index)" class="check-btn">
                ‚úì –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
              </button>
            </div>
            <div v-if="exercise.feedback" :class="['feedback', exercise.isCorrect ? 'correct' : 'incorrect']">
              {{ exercise.feedback }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="conclusion">
      <h3>üéì –í–∏—Å–Ω–æ–≤–æ–∫</h3>
      <p>–†–æ–∑—É–º—ñ–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ –∫–æ–¥—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö ‚Äì —Ü–µ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ü–∏—Ñ—Ä–æ–≤–∏–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è–º–∏ —Ç–∞ –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏–º–∏ –Ω–∞—É–∫–∞–º–∏.</p>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'

// Reactive data
const inputText = ref('Hello')
const rgbColor = ref({ r: 255, g: 0, b: 0 })
const fileData = ref(null)
const textContent = ref('')
const selectedFormat = ref('HEX')
const decoderMode = ref('ascii')
const decodeInput = ref('')
const decodeResult = ref('')
const isDragOver = ref(false)
const uploadStatus = ref(null)

// ASCII codes for display (printable characters)
const asciiCodes = Array.from({ length: 95 }, (_, i) => i + 32)

// Unicode examples
const unicodeExamples = ref([
  { char: '–ê', name: '–ö–∏—Ä–∏–ª–∏—Ü—è –ê', code: '0410' },
  { char: '√±', name: '–õ–∞—Ç–∏–Ω–∏—Ü—è –∑ —Ç—ñ–ª—å–¥–æ—é', code: '00F1' },
  { char: '‰∏≠', name: '–ö–∏—Ç–∞–π—Å—å–∫–∏–π —ñ—î—Ä–æ–≥–ª—ñ—Ñ', code: '4E2D' },
  { char: 'üåü', name: '–ó—ñ—Ä–∫–∞ –µ–º–æ–¥–∑—ñ', code: '1F31F' },
  { char: '‚Ç¨', name: '–ó–Ω–∞–∫ —î–≤—Ä–æ', code: '20AC' },
])

// Color presets for CMYK
const colorPresets = ref([
  { name: '–ß–µ—Ä–≤–æ–Ω–∏–π', cmyk: { c: 0, m: 100, y: 100, k: 0 }, hex: '#FF0000' },
  { name: '–°–∏–Ω—ñ–π', cmyk: { c: 100, m: 100, y: 0, k: 0 }, hex: '#0000FF' },
  { name: '–ñ–æ–≤—Ç–∏–π', cmyk: { c: 0, m: 0, y: 100, k: 0 }, hex: '#FFFF00' },
  { name: '–ó–µ–ª–µ–Ω–∏–π', cmyk: { c: 100, m: 0, y: 100, k: 0 }, hex: '#00FF00' },
  { name: '–ß–æ—Ä–Ω–∏–π', cmyk: { c: 0, m: 0, y: 0, k: 100 }, hex: '#000000' },
])

// Binary formats
const binaryFormats = ['HEX', '–î–µ—Å—è—Ç–∫–æ–≤–∞', '–î–≤—ñ–π–∫–æ–≤–∞']

// Decoder modes
const decoderModes = [
  { id: 'ascii', name: 'ASCII ‚Üí –¢–µ–∫—Å—Ç' },
  { id: 'binary', name: '–î–≤—ñ–π–∫–æ–≤–∞ ‚Üí –¢–µ–∫—Å—Ç' },
  { id: 'hex', name: 'HEX ‚Üí –¢–µ–∫—Å—Ç' },
]

// Practice exercises
const practiceExercises = ref([
  {
    question: '–Ø–∫–∏–π ASCII –∫–æ–¥ –º–∞—î —Å–∏–º–≤–æ–ª "A"?',
    hint: '–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ —Ç–∞–±–ª–∏—Ü—ñ ASCII –≤–∏—â–µ',
    placeholder: '–í–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ',
    answer: '65',
    userAnswer: '',
    feedback: '',
    isCorrect: false
  },
  {
    question: '–ü–µ—Ä–µ—Ç–≤–æ—Ä—ñ—Ç—å —á–∏—Å–ª–æ 72 –≤ ASCII —Å–∏–º–≤–æ–ª',
    hint: '–í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—é ASCII',
    placeholder: '–í–≤–µ–¥—ñ—Ç—å —Å–∏–º–≤–æ–ª',
    answer: 'H',
    userAnswer: '',
    feedback: '',
    isCorrect: false
  },
  {
    question: '–Ø–∫–µ HEX –∑–Ω–∞—á–µ–Ω–Ω—è –º–∞—î –±—ñ–ª–∏–π –∫–æ–ª—ñ—Ä –≤ RGB?',
    hint: '–ë—ñ–ª–∏–π = –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è R, G, B',
    placeholder: '–í–≤–µ–¥—ñ—Ç—å HEX –∫–æ–¥',
    answer: '#FFFFFF',
    userAnswer: '',
    feedback: '',
    isCorrect: false
  }
])

// Methods
const getAsciiCodes = (text) => {
  return text.split('').map(char => char.charCodeAt(0)).join(', ')
}

const getBinaryRepresentation = (text) => {
  return text.split('').map(char =>
    char.charCodeAt(0).toString(2).padStart(8, '0')
  ).join(' ')
}

const addCharToInput = (char) => {
  if (inputText.value.length < 20) {
    inputText.value += char
  }
}

const getRgbHex = () => {
  const toHex = (n) => n.toString(16).padStart(2, '0').toUpperCase()
  return `#${toHex(rgbColor.value.r)}${toHex(rgbColor.value.g)}${toHex(rgbColor.value.b)}`
}

const getRgbBinary = () => {
  const toBinary = (n) => n.toString(2).padStart(8, '0')
  return `${toBinary(rgbColor.value.r)} ${toBinary(rgbColor.value.g)} ${toBinary(rgbColor.value.b)}`
}

const applyCmykPreset = (preset) => {
  // Convert hex to RGB for display
  const hex = preset.hex.substring(1)
  rgbColor.value = {
    r: parseInt(hex.substr(0, 2), 16),
    g: parseInt(hex.substr(2, 2), 16),
    b: parseInt(hex.substr(4, 2), 16)
  }
}

const handleFileSelect = (event) => {
  const file = event.target.files[0]
  if (file) {
    processFile(file)
  }
}

const handleFileDrop = (event) => {
  event.preventDefault()
  isDragOver.value = false
  const file = event.dataTransfer.files[0]
  if (file) {
    processFile(file)
  }
}

const processFile = (file) => {
  // Reset previous data
  fileData.value = null
  textContent.value = ''
  uploadStatus.value = null

  // Check file size
  if (file.size > 1048576) { // 1MB limit
    uploadStatus.value = {
      type: 'error',
      message: `–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: ${(file.size / 1048576).toFixed(1)}–ú–ë. –ú–∞–∫—Å–∏–º—É–º: 1–ú–ë`
    }
    return
  }

  uploadStatus.value = {
    type: 'loading',
    message: '–ó–∞–≤–∞–Ω—Ç–∞–∂—É—é —Ñ–∞–π–ª...'
  }

  // Set basic file info immediately
  fileData.value = {
    name: file.name,
    size: file.size,
    type: file.type || '–ù–µ–≤—ñ–¥–æ–º–∏–π',
    bytes: []
  }

  const reader = new FileReader()
  reader.onload = (e) => {
    try {
      const arrayBuffer = e.target.result
      const bytes = new Uint8Array(arrayBuffer)
      fileData.value.bytes = Array.from(bytes.slice(0, 64)) // First 64 bytes

      uploadStatus.value = {
        type: 'success',
        message: '–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!'
      }

      // Clear status after 3 seconds
      setTimeout(() => {
        uploadStatus.value = null
      }, 3000)

      // If text file, show preview
      if (file.type?.startsWith('text/') || file.name.endsWith('.txt')) {
        const textReader = new FileReader()
        textReader.onload = (e) => {
          const content = e.target.result
          textContent.value = content.length > 200 ? content.substring(0, 200) + '...' : content
        }
        textReader.readAsText(file)
      }
    } catch (error) {
      console.error('Error processing file:', error)
      uploadStatus.value = {
        type: 'error',
        message: '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ —Ñ–∞–π–ª—É'
      }
    }
  }

  reader.onerror = () => {
    uploadStatus.value = {
      type: 'error',
      message: '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —á–∏—Ç–∞–Ω–Ω—ñ —Ñ–∞–π–ª—É'
    }
  }

  reader.readAsArrayBuffer(file)
}

const getFormattedBinary = () => {
  if (!fileData.value?.bytes) return ''

  switch (selectedFormat.value) {
    case 'HEX':
      return fileData.value.bytes.map(b => b.toString(16).padStart(2, '0').toUpperCase()).join(' ')
    case '–î–µ—Å—è—Ç–∫–æ–≤–∞':
      return fileData.value.bytes.join(', ')
    case '–î–≤—ñ–π–∫–æ–≤–∞':
      return fileData.value.bytes.map(b => b.toString(2).padStart(8, '0')).join(' ')
    default:
      return ''
  }
}

const getCurrentModeLabel = () => {
  const mode = decoderModes.find(m => m.id === decoderMode.value)
  return `–í–≤–µ–¥—ñ—Ç—å ${mode.name.split(' ‚Üí ')[0]} –∫–æ–¥`
}

const getCurrentModePlaceholder = () => {
  switch (decoderMode.value) {
    case 'ascii': return '72 101 108 108 111'
    case 'binary': return '01001000 01100101 01101100 01101100 01101111'
    case 'hex': return '48 65 6C 6C 6F'
    default: return ''
  }
}

const performDecode = () => {
  try {
    let result = ''
    const input = decodeInput.value.trim()

    switch (decoderMode.value) {
      case 'ascii':
        result = input.split(/\s+/).map(code => String.fromCharCode(parseInt(code))).join('')
        break
      case 'binary':
        result = input.split(/\s+/).map(bin => String.fromCharCode(parseInt(bin, 2))).join('')
        break
      case 'hex':
        result = input.split(/\s+/).map(hex => String.fromCharCode(parseInt(hex, 16))).join('')
        break
    }

    decodeResult.value = result || '–ü–æ–º–∏–ª–∫–∞ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è'
  } catch (error) {
    decodeResult.value = '–ü–æ–º–∏–ª–∫–∞: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö'
  }
}

const checkAnswer = (index) => {
  const exercise = practiceExercises.value[index]
  const userAnswer = exercise.userAnswer.trim().toUpperCase()
  const correctAnswer = exercise.answer.toUpperCase()

  exercise.isCorrect = userAnswer === correctAnswer
  exercise.feedback = exercise.isCorrect
    ? '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!'
    : `‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${exercise.answer}`
}
</script>

<style scoped>
.section {
  margin-bottom: 40px;
  padding: 30px;
  border-radius: 6px;
  border-left: 4px solid #dee2e6;
}

.section-1 {
  background: #f8f9fa;
  border-left-color: #6f42c1;
}

.section-2 {
  background: #f8f9fa;
  border-left-color: #20c997;
}

.section-3 {
  background: #f8f9fa;
  border-left-color: #fd7e14;
}

.section-4 {
  background: #f8f9fa;
  border-left-color: #dc3545;
}

.section-5 {
  background: #f8f9fa;
  border-left-color: #0d6efd;
}

.section h2 {
  color: #2c3e50;
  font-size: 1.8em;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid rgba(255,255,255,0.5);
}

.section h3 {
  color: #34495e;
  font-size: 1.3em;
  margin: 20px 0 10px 0;
}

.definition-box {
  background: white;
  padding: 20px;
  border-radius: 6px;
  margin: 20px 0;
  border: 1px solid #e9ecef;
  border-left: 4px solid #6c757d;
}

.definition-box strong {
  color: #2c3e50;
}

.visual-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.info-card {
  background: white;
  padding: 20px;
  border-radius: 6px;
  text-align: center;
  border: 1px solid #e9ecef;
  transition: transform 0.2s ease;
}

.info-card:hover {
  transform: translateY(-2px);
  border-color: #dee2e6;
}

.icon {
  font-size: 2.5em;
  margin-bottom: 10px;
  display: block;
}

.example-box {
  background: #fff3cd;
  padding: 15px;
  border-radius: 6px;
  margin: 15px 0;
  border: 1px solid #ffeaa7;
  border-left: 4px solid #f39c12;
}

/* Text encoding styles */
.encoding-demo {
  background: white;
  padding: 25px;
  border-radius: 8px;
  margin: 20px 0;
}

.text-encoder {
  margin-bottom: 30px;
}

.input-group {
  margin-bottom: 20px;
}

.input-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #495057;
}

.input-group input {
  width: 100%;
  padding: 12px;
  border: 2px solid #e9ecef;
  border-radius: 6px;
  font-size: 16px;
  transition: border-color 0.2s ease;
}

.input-group input:focus {
  outline: none;
  border-color: #007bff;
}

.encoding-results {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-top: 20px;
}

.result-box {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 6px;
  border: 1px solid #e9ecef;
}

.result-box h4 {
  margin: 0 0 10px 0;
  color: #495057;
}

.code-display, .binary-display {
  font-family: 'Courier New', monospace;
  background: white;
  padding: 10px;
  border-radius: 4px;
  border: 1px solid #dee2e6;
  min-height: 20px;
}

.ascii-table {
  margin-top: 30px;
}

.ascii-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
  gap: 8px;
  margin-top: 15px;
}

.ascii-cell {
  background: white;
  border: 1px solid #e9ecef;
  border-radius: 4px;
  padding: 8px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
}

.ascii-cell:hover {
  background: #e3f2fd;
  border-color: #2196f3;
  transform: scale(1.05);
}

.ascii-char {
  font-weight: bold;
  font-size: 18px;
  margin-bottom: 4px;
}

.ascii-code {
  font-size: 12px;
  color: #6c757d;
}

.unicode-section {
  margin-top: 30px;
}

.unicode-examples {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.unicode-card {
  background: white;
  padding: 15px;
  border-radius: 6px;
  border: 1px solid #e9ecef;
  display: flex;
  align-items: center;
  gap: 15px;
}

.unicode-char {
  font-size: 24px;
  min-width: 40px;
  text-align: center;
}

.unicode-info {
  font-size: 14px;
  color: #495057;
}

/* Color encoding styles */
.color-models {
  background: white;
  padding: 25px;
  border-radius: 8px;
}

.rgb-demo {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin: 20px 0;
}

.slider-group {
  margin-bottom: 20px;
}

.slider-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
}

.color-slider {
  width: calc(100% - 60px);
  margin-right: 10px;
}

.value {
  display: inline-block;
  width: 40px;
  text-align: center;
  font-weight: bold;
}

.color-preview {
  text-align: center;
}

.color-swatch {
  width: 150px;
  height: 150px;
  border-radius: 8px;
  margin: 0 auto 20px;
  border: 2px solid #dee2e6;
}

.color-codes {
  text-align: left;
  background: #f8f9fa;
  padding: 15px;
  border-radius: 6px;
}

.color-codes div {
  margin-bottom: 5px;
}

.cmyk-demo {
  margin-top: 20px;
}

.preset-colors {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.preset-card {
  background: white;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 15px;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 15px;
}

.preset-card:hover {
  border-color: #007bff;
  transform: translateY(-2px);
}

.preset-swatch {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid #dee2e6;
}

.preset-info {
  font-size: 14px;
}

/* File upload styles */
.file-upload-demo {
  background: white;
  padding: 25px;
  border-radius: 8px;
}

.upload-zone {
  border: 2px dashed #dee2e6;
  border-radius: 8px;
  padding: 40px;
  text-align: center;
  margin: 20px 0;
  transition: border-color 0.2s ease;
}

.upload-zone:hover {
  border-color: #007bff;
}

.upload-zone.drag-over {
  border-color: #28a745;
  background-color: #f8fff9;
}

.upload-btn {
  background: #007bff;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  margin-bottom: 10px;
}

.upload-btn:hover {
  background: #0056b3;
}

.upload-status {
  margin-top: 15px;
  padding: 10px 15px;
  border-radius: 6px;
  font-weight: 600;
  text-align: center;
}

.upload-status.loading {
  background: #e3f2fd;
  color: #1976d2;
  border: 1px solid #bbdefb;
}

.upload-status.success {
  background: #e8f5e8;
  color: #2e7d32;
  border: 1px solid #c8e6c9;
}

.upload-status.error {
  background: #ffebee;
  color: #c62828;
  border: 1px solid #ffcdd2;
}

.file-analysis {
  margin-top: 30px;
}

.file-info {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 6px;
  margin-bottom: 20px;
}

.file-info div {
  margin-bottom: 5px;
}

.format-tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.format-btn {
  background: #e9ecef;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.format-btn.active {
  background: #007bff;
  color: white;
}

.binary-display {
  background: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 6px;
  padding: 15px;
  margin-bottom: 20px;
}

.binary-content {
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.6;
  word-break: break-all;
}

.text-preview .text-content {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 6px;
  border: 1px solid #e9ecef;
  font-family: monospace;
  max-height: 150px;
  overflow-y: auto;
}

/* Decoder styles */
.decoder-tool {
  background: white;
  padding: 25px;
  border-radius: 8px;
  margin-bottom: 30px;
}

.decoder-modes {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.mode-btn {
  background: #e9ecef;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.mode-btn.active {
  background: #007bff;
  color: white;
}

.decoder-interface {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
}

.input-section label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
}

.input-section textarea {
  width: 100%;
  padding: 12px;
  border: 2px solid #e9ecef;
  border-radius: 6px;
  font-family: 'Courier New', monospace;
  resize: vertical;
  margin-bottom: 15px;
}

.decode-btn {
  background: #28a745;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
}

.decode-btn:hover {
  background: #218838;
}

.result-section {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 6px;
  border: 1px solid #e9ecef;
}

.decode-output {
  background: white;
  padding: 15px;
  border-radius: 4px;
  border: 1px solid #dee2e6;
  font-family: monospace;
  min-height: 60px;
}

/* Practice exercises */
.practice-exercises {
  background: white;
  padding: 25px;
  border-radius: 8px;
}

.exercise-list {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.exercise-card {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 6px;
  border: 1px solid #e9ecef;
}

.exercise-question {
  margin-bottom: 10px;
  font-size: 16px;
}

.exercise-hint {
  margin-bottom: 15px;
  color: #6c757d;
}

.exercise-answer {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-bottom: 10px;
}

.exercise-answer input {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #e9ecef;
  border-radius: 4px;
}

.check-btn {
  background: #17a2b8;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
}

.check-btn:hover {
  background: #138496;
}

.feedback {
  padding: 10px;
  border-radius: 4px;
  font-weight: 600;
}

.feedback.correct {
  background: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.feedback.incorrect {
  background: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

.conclusion {
  text-align: center;
  margin: 40px 0;
  padding: 20px;
  background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
  border-radius: 10px;
  color: white;
}

.conclusion p {
  font-size: 1.1em;
}

@media (max-width: 768px) {
  .container {
    margin: 10px;
    padding: 15px;
  }

  .encoding-results,
  .rgb-demo,
  .decoder-interface {
    grid-template-columns: 1fr;
    gap: 20px;
  }

  .exercise-answer {
    flex-direction: column;
    align-items: stretch;
  }

  .decoder-modes,
  .format-tabs {
    flex-direction: column;
  }
}
</style>